{"version":3,"sources":["athens/listeners.cljs"],"mappings":";;;;;;;;AAeA,AAAA,AAAMA,AACHC;AADH,AAGE,AAAMC,AAAc,AAAA,AAAA,AAAID;AAClBE,AAAqB,AAAA,AAAA,AAAIF;AACzBG,AAAoB,AAAA,AAAA,AAAIH;AACxBI,AAAQ,AAAAC,AAAIJ;AAAJ,AAAA,AAAAI;AAAAA;;AAAA,AAAAA,AAAkBH;AAAlB,AAAA,AAAAG;AAAAA;;AAAuCF;;;;AAHrD,AAIE,AAAMC;AAAN,AACE,AAAAE,AAAA,AAAA,AAAwB,AAAA,AAAIF;AAA5B,AAAA,AAAAE,AAAAA,AAACC,AAAAA,AAAAA;;AADH;;;AAMJ,AAAA,AAAMC,AACHR;AADH,AAEE,AAAA,AAAAS,AAAMC,AAAS,AAAAC,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACC,AAAAA,AAAAA;;AACVR,AAAQ,AAAA,AAAA,AAAIJ;AADlB,AAEE,AAAM,AAAAa,AAAKH;AAAL,AAAA,AAAAG;AAAa,AAAA,AAAMT;;AAAnBS;;;AAAN,AACE,AAAAC,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACP,AAAAA,AAAAA;;AADH;;;AAOJ,AAAA,AAAMQ,AACHf;AADH,AAEE,AAAMgB,AAAI,AAAIhB;AACRiB,AAAK,AAAIjB;AACTkB,AAAK,AAAIlB;AACTmB,AAAM,AAAInB;AAHhB,AAKE,AACE,AAAA,AAAAa,AAAK,AAACO,AAAEJ,AAAIK,AAAYH;AAAxB,AAAA,AAAAL;AAA6BM;;AAA7BN;;AAAA;AACA,AAAAS,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACf,AAAAA,AAAAA;;AAFH,AAIE,AAAA,AAAK,AAACa,AAAEJ,AAAIK,AAAYH;AACxB,AAAAK,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAAChB,AAAAA,AAAAA;;AALH,AAOE,AAAA,AAAK,AAACa,AAAEJ,AAAIQ,AAAYN;AACxB,AAAAO,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAAClB,AAAAA,AAAAA;;AARH,AAUE,AAAA,AAAK,AAACa,AAAEJ,AAAIU,AAAYT;AACxB,AAAAU,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACpB,AAAAA,AAAAA;;AAXH,AAaE,AAAA,AAAK,AAACa,AAAEJ,AAAIY,AAAYX;AACxB,AAAAY,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACtB,AAAAA,AAAAA;;AAdH,AAgBE,AAAA,AAAK,AAACa,AAAEJ,AAAIc,AAAYb;AACxB,AAAAc,AAAA,AAAA;AAAA,AAAA,AAAAA,AAAAA,AAACxB,AAAAA,AAAAA;;AAjBH;;;;;;;;AAoBJ,AAAA,AAAMyB;AAAN,AAEE,AAACC,AAAcC,AAAUC,AAAoBpC;;AAC7C,AAACkC,AAAcC,AAAUC,AAAoB3B;;AAC7C,AAACyB,AAAcC,AAAUE,AAAkBrB","names":["athens.listeners/edit-block","e","closest-block","closest-block-header","closest-page-header","closest","or__4185__auto__","G__61709","re-frame.core/dispatch","athens.listeners/mouse-down-outside-athena","cljs.core/deref","athena?","G__61710","re-frame.core/subscribe","and__4174__auto__","G__61711","athens.listeners/key-down","key","ctrl","meta","shift","cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2","goog.events.KeyCodes/Z","G__61712","G__61713","goog.events.KeyCodes/K","G__61714","goog.events.KeyCodes/G","G__61715","goog.events.KeyCodes/R","G__61716","goog.events.KeyCodes/L","G__61717","athens.listeners/init","goog.events/listen","js/window","goog.events.EventType/MOUSEDOWN","goog.events.EventType/KEYDOWN"],"sourcesContent":["(ns athens.listeners\n  (:require\n    ;;[athens.util :refer [get-day]]\n    [cljsjs.react]\n    [cljsjs.react.dom]\n    [goog.events :as events]\n    [re-frame.core :refer [dispatch subscribe]])\n  (:import\n    (goog.events\n      EventType\n      KeyCodes)))\n\n\n;; -- Turn read block or header into editable on mouse down --------------\n\n(defn edit-block\n  [e]\n  ;; Consider refactor if we add more editable targets\n  (let [closest-block (.. e -target (closest \".block-contents\"))\n        closest-block-header (.. e -target (closest \".block-header\"))\n        closest-page-header (.. e -target (closest \".page-header\"))\n        closest (or closest-block closest-block-header closest-page-header)]\n    (when closest\n      (dispatch [:editing/uid (.. closest -dataset -uid)]))))\n\n\n;; -- Close Athena -------------------------------------------------------\n\n(defn mouse-down-outside-athena\n  [e]\n  (let [athena? @(subscribe [:athena/open])\n        closest (.. e -target (closest \".athena\"))]\n    (when (and athena? (nil? closest))\n      (dispatch [:athena/toggle]))))\n\n\n;; -- Hotkeys ------------------------------------------------------------\n\n\n(defn key-down\n  [e]\n  (let [key (.. e -keyCode)\n        ctrl (.. e -ctrlKey)\n        meta (.. e -metaKey)\n        shift (.. e -shiftKey)]\n\n    (cond\n      (and (= key KeyCodes.Z) meta shift)\n      (dispatch [:redo])\n\n      (and (= key KeyCodes.Z) meta)\n      (dispatch [:undo])\n\n      (and (= key KeyCodes.K) meta)\n      (dispatch [:athena/toggle])\n\n      (and (= key KeyCodes.G) ctrl)\n      (dispatch [:devtool/toggle])\n\n      (and (= key KeyCodes.R) ctrl)\n      (dispatch [:right-sidebar/toggle])\n\n      (and (= key KeyCodes.L) ctrl)\n      (dispatch [:left-sidebar/toggle]))))\n\n\n(defn init\n  []\n  (events/listen js/window EventType.MOUSEDOWN edit-block)\n  (events/listen js/window EventType.MOUSEDOWN mouse-down-outside-athena)\n  (events/listen js/window EventType.KEYDOWN key-down))\n\n"]}